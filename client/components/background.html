<canvas id="backgroundCanvas"></canvas>

<style>
#background {
    position: absolute;
    width: 100%;
    height: 100%;
}
</style>

<script>
var ctx = backgroundCanvas.getContext('2d');

backgroundCanvas.width = window.innerWidth;
backgroundCanvas.height = window.innerHeight;
alert('Click to activate full screen mode.');
var m = [];

function Update() {
  
    backgroundCanvas.width = window.innerWidth;
    backgroundCanvas.height = window.innerHeight;

    ctx.clearRect(0, 0, backgroundCanvas.width, backgroundCanvas.height);
    Draw();
    move();
    //optimization();
    requestAnimationFrame(Update);
}

function Draw() {
    for (var i = 0; i < m.length; i++) {
        ctx.fillStyle = "rgb(" + m[i][4] + "," + m[i][5] + "," + m[i][6] + ")";
        ctx.fillRect(m[i][0], m[i][1], 7, 7);
    }
}

function move() {
    for (var i = 0; i < m.length; i++) {
        m[i][0] += m[i][2];
        m[i][1] += m[i][3];
    }
}
function fullScreen(element) {
    if (element.requestFullscreen) {
        element.requestFullscreen();
    } else if (element.webkitrequestFullscreen) {
        element.webkitRequestFullscreen();
    } else if (element.mozRequestFullscreen) {
        element.mozRequestFullScreen();
    }
    
}
backgroundCanvas.onclick = function(e) {
    //fullScreen(backgroundCanvas);
    var xCl = e.clientX;
    var yCl = e.clientY;
    for (var k = 0; k < 10; k++) {
        m.push([]);
        m[m.length - 1].push(xCl);
        m[m.length - 1].push(yCl);
        m[m.length - 1].push(randomInteger(-50 / 10, 50 / 10));
        m[m.length - 1].push(randomInteger(-50 / 10, 50 / 10));
        var rgb = {
            r: randomInteger(0, 255),
            g: randomInteger(0, 255),
            b: randomInteger(0, 255)
        };
        m[m.length - 1].push(rgb.r);
        m[m.length - 1].push(rgb.g);
        m[m.length - 1].push(rgb.b);
        m[m.length - 1].push(3);
    }

}

backgroundCanvas.onmousemove = (e) => {
    var xCl = e.clientX;
    var yCl = e.clientY;
    for (var k = 0; k < 10; k++) {
        m.push([]);
        m[m.length - 1].push(xCl);
        m[m.length - 1].push(yCl);
        m[m.length - 1].push(randomInteger(-50 / 10, 50 / 10));
        m[m.length - 1].push(randomInteger(-50 / 10, 50 / 10));
        var rgb = {
            r: randomInteger(0, 255),
            g: randomInteger(0, 255),
            b: randomInteger(0, 255)
                //r: 0,
                //g: 0,
                //b: 0
        };
        m[m.length - 1].push(rgb.r);
        m[m.length - 1].push(rgb.g);
        m[m.length - 1].push(rgb.b);
        m[m.length - 1].push(3);
    }
}

function optimization() {
    /*for (var i = 0; i < m.length; i++) {
        if (m[i][0] < 0) {
            m[i].splice(1, 1);
        }
        if (m[i][0] > 1360) {
            m[i].splice(1, 1);
        }
        if (m[i][1] < 0) {
            m[i].splice(1, 1);
        }
        if (m[i][1] > 700) {
            m[i].splice(1, 1);
        }
    }*/

    for (var i = 0; i < m.length; i++) {
        m[i][7]--;
        if (m[i][7] < 0) {
            m.splice(i, 1);
        }
    }
    setTimeout(optimization, 600);
}

function randomInteger(min, max) {
    let rand = min + Math.random() * (max - min);
    return Math.round(rand);
}

backgroundCanvas.addEventListener('touchmove', function(e) {
    var touchobj = e.changedTouches[0] // первая точка прикосновения для данного события
    var dist = parseInt(touchobj.clientX);


    var xCl = touchobj.clientX;
    var yCl = touchobj.clientY;
    for (var k = 0; k < 10; k++) {
        m.push([]);
        m[m.length - 1].push(xCl);
        m[m.length - 1].push(yCl);
        m[m.length - 1].push(randomInteger(-50 / 10, 50 / 10));
        m[m.length - 1].push(randomInteger(-50 / 10, 50 / 10));
        var rgb = {
            r: randomInteger(0, 255),
            g: randomInteger(0, 255),
            b: randomInteger(0, 255)
        };
        m[m.length - 1].push(rgb.r);
        m[m.length - 1].push(rgb.g);
        m[m.length - 1].push(rgb.b);
        m[m.length - 1].push(3);
    }
    e.preventDefault()
}, false)

Update();
optimization();
</script>